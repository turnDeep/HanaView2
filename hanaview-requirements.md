# HanaView 要件定義書

## 1. プロジェクト概要

### 1.1 背景と目的
個人投資家が毎朝の市場チェックに多くの時間を費やしている現状を改善し、効率的に市場情報を把握できるツールが必要とされている。

**目的：** 毎朝5分で米国市場の重要情報を確認できる統合ダッシュボードを提供する

### 1.2 スコープ
- 米国株式市場の主要指標の可視化
- 市況ニュースの自動収集と表示
- AIによる市況解説の自動生成
- 経済指標カレンダーの提供
- 週次投資コラムの自動生成

### 1.3 ターゲットユーザー
- 日本在住の個人投資家
- 米国株投資を行っている、または検討している個人
- 毎朝の市場チェックを効率化したい投資家

## 2. 機能要件

### 2.1 市況概観機能
#### 2.1.1 Fear & Greed Index表示
- **目的：** 市場のセンチメントを数値で正確に把握
- **要件：**
  - CNN Fear & Greed APIからインデックスデータを取得
  - 以下のデータを表示：
    - 現在のインデックス値とカテゴリ
    - 前日比
    - 1週間前、1ヶ月前、1年前のデータ
  - 毎日自動更新

#### 2.1.2 VIX指数チャート
- **目的：** ボラティリティの推移を把握
- **要件：**
  - 過去5日分の4時間足チャートを表示
  - リアルタイムに近いデータ（15分遅延）を取得
  - 現在値を強調表示

#### 2.1.3 米国10年債先物チャート
- **目的：** 金利動向を把握
- **要件：**
  - 過去5日分の4時間足チャートを表示
  - ^TNX（10年債利回り）データを使用
  - 現在値を強調表示

#### 2.1.4 AI市況解説
- **目的：** 初心者でも理解できる市況サマリー提供
- **要件：**
  - OpenAI APIを使用した自動解説生成
  - 150文字程度の簡潔な解説
  - VIXと10年債データに基づく分析

### 2.2 ヒートマップ機能
#### 2.2.1 NASDAQ 100ヒートマップ
- **目的：** NASDAQ主要銘柄のパフォーマンスを一覧表示
- **要件：**
  - HWB-botと同様の手法で各銘柄データを取得
  - FinvizのNASDAQ 100ヒートマップを完全再現したCSSデザイン
  - 1-Day、1-Week、1-Monthの順で表示
  - セクター別の色分け表示
  - AI解説：取得したデータから市場傾向を分析

#### 2.2.2 S&P 500ヒートマップ
- **目的：** S&P500構成銘柄のパフォーマンスを一覧表示
- **要件：**
  - HWB-botと同様の手法で各銘柄データを取得
  - FinvizのS&P 500ヒートマップを完全再現したCSSデザイン
  - 1-Day、1-Week、1-Monthの順で表示
  - セクター別の色分け表示
  - AI解説：取得したデータから市場傾向を分析

### 2.3 ニュース機能
- **目的：** 短時間で市場の空気感と重要材料を把握
- **要件：**
  - OpenAI APIによる自動生成
  - 構成要素：
    * **今週の3行サマリー**: 全体のムードを伝える（事実＋AIの解釈）
    * **主要トピック3つ**: 「事実→解釈→市場への影響」を端的に説明
  - 毎朝自動更新

### 2.4 経済指標カレンダー
- **目的：** 重要な経済イベントを事前把握
- **要件：**
  - みんかぶFXから経済指標情報を取得
  - **対象期間**: 当日朝7時から翌日朝7時まで
  - **表示条件**: 重要度★★★（3つ星）以上のみ
  - 表示項目：時刻、指標名、予測、前回、重要度（星の数）
  - **今日の注目決算**: AIが大型株決算から厳選

### 2.5 AI解説機能
- **目的：** 週次の投資戦略参考情報を提供
- **要件：**
  - 毎週月曜日に自動生成
  - 各種データに基づく総合的な分析

### 2.6 データ更新機能
- **目的：** 最新データの自動取得
- **要件：**
  - 毎日朝6:30にデータ取得（fetch）
  - 毎日朝7:00にレポート生成（generate）
  - cronによる自動実行
  - ログ記録機能

## 3. 非機能要件

### 3.1 パフォーマンス要件
- ページ読み込み時間：3秒以内
- データ更新処理：10分以内で完了
- チャート描画：1秒以内

### 3.2 可用性要件
- サービス稼働率：99%以上
- データ取得失敗時のフォールバック機能
- エラー発生時の適切なメッセージ表示

### 3.3 セキュリティ要件
- APIキーの環境変数管理
- HTTPSによる通信（本番環境）
- 外部APIアクセスのレート制限対応

### 3.4 運用要件
- Dockerによるコンテナ化
- ログファイルの自動ローテーション
- 7日以前のデータファイル自動削除

### 3.5 互換性要件
- モバイル端末対応（レスポンシブデザイン）
- 主要ブラウザ対応（Chrome、Safari、Firefox、Edge）
- タブレット端末での表示最適化

## 4. 制約事項

### 4.1 技術的制約
- yfinanceの15分遅延データ
- 外部APIのレート制限
- OpenAI APIの利用料金制約

### 4.2 法的制約
- 金融データの再配布に関する制限
- 投資助言に該当しない内容制限

### 4.3 運用制約
- 米国市場の営業時間（夏時間・冬時間）考慮
- 日本時間での表示・運用
- 手動での初回データ取得が必要

## 5. 前提条件

- Docker環境が利用可能
- OpenAI APIキーを保有
- インターネット接続環境
- 最低2GBのストレージ容量

## 6. 用語定義

| 用語 | 定義 |
|------|------|
| VIX | ボラティリティ・インデックス、恐怖指数 |
| Fear & Greed Index | CNNが提供する市場センチメント指標 |
| ヒートマップ | 数値データを色で視覚化した図表 |
| 4時間足 | 4時間ごとの価格変動を示すチャート |
| FOMC | 連邦公開市場委員会 |